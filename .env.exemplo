# ------------------------------------------------------------------------------
# pyloto_corp — .env.exemplo (DEV/LOCAL)
# Produção (Cloud Run): preferir Secret Manager + Service Account; não usar .env.
# Conforme TODO_01_INFRAESTRUTURA_E_SERVICOS.md
# ------------------------------------------------------------------------------

# App identity
SERVICE_NAME=pyloto_corp
VERSION=0.1.0

# Runtime
ENVIRONMENT=development
LOG_LEVEL=INFO
TIMEZONE=America/Sao_Paulo

# ------------------------------------------------------------------------------
# Dedupe backend (conforme TODO_01)
# ------------------------------------------------------------------------------
# memory | redis
DEDUPE_BACKEND=memory

# Se DEDUPE_BACKEND=redis:
# Pode conter credenciais => trate como secret em produção.
REDIS_URL=redis://localhost:6379/0
DEDUPE_TTL_SECONDS=86400

# ------------------------------------------------------------------------------
# Firestore (conforme TODO_01)
# ------------------------------------------------------------------------------
FIRESTORE_PROJECT_ID=pyloto-corp-dev
FIRESTORE_DATABASE_ID=(default)
CONVERSATIONS_COLLECTION=conversations
USER_PROFILES_COLLECTION=user_profiles
AUDIT_LOGS_COLLECTION=audit_logs
TEMPLATES_COLLECTION=templates
EXPORTS_COLLECTION=exports

# ------------------------------------------------------------------------------
# GCS Buckets (conforme TODO_01)
# ------------------------------------------------------------------------------
GCS_BUCKET_MEDIA=pyloto-whatsapp-media-dev
GCS_BUCKET_EXPORT=pyloto-exports-dev
GCS_MEDIA_RETENTION_DAYS=90
GCS_EXPORT_RETENTION_DAYS=180
EXPORT_SIGNED_URL_EXPIRY_DAYS=7
EXPORT_INCLUDE_PII_DEFAULT=false

# ------------------------------------------------------------------------------
# Pub/Sub (opcional, conforme TODO_01)
# ------------------------------------------------------------------------------
PUBSUB_ENABLED=false
PUBSUB_TOPIC_INBOUND=whatsapp-inbound-messages
PUBSUB_TOPIC_OUTBOUND=whatsapp-outbound-responses
PUBSUB_TOPIC_HANDOFF=handoff-human
PUBSUB_TOPIC_AUDIT=audit-events

# ------------------------------------------------------------------------------
# Sessão (conforme Funcionamento.md)
# ------------------------------------------------------------------------------
SESSION_TIMEOUT_MINUTES=30
SESSION_MAX_INTENTS=3
SESSION_AWAITING_TIMEOUT_MINUTES=10

# ------------------------------------------------------------------------------
# WhatsApp (Meta Cloud API) — secrets e IDs (conforme TODO_01)
# ------------------------------------------------------------------------------
WHATSAPP_VERIFY_TOKEN=change-me-verify-token
WHATSAPP_WEBHOOK_SECRET=change-me-webhook-secret
WHATSAPP_ACCESS_TOKEN=change-me-access-token

# Não é "secret criptográfico", mas é sensível.
WHATSAPP_PHONE_NUMBER_ID=000000000000000
WHATSAPP_BUSINESS_ACCOUNT_ID=000000000000000

# Versão da Graph API (conforme README.md jan/2026)
WHATSAPP_API_VERSION=v24.0
WHATSAPP_API_BASE_URL=https://graph.facebook.com

# Configurações de outbound
WHATSAPP_MAX_RETRIES=3
WHATSAPP_RETRY_BACKOFF_SECONDS=2
WHATSAPP_REQUEST_TIMEOUT_SECONDS=30
WHATSAPP_MAX_BATCH_SIZE=100

# SECRET: usado para derivar user_key = HMAC(PEPPER_SECRET, phone_e164)
PEPPER_SECRET=change-me-pepper-secret

# ------------------------------------------------------------------------------
# Segurança (conforme regras_e_padroes.md)
# ------------------------------------------------------------------------------
ZERO_TRUST_MODE=true
PII_MASKING_ENABLED=true
MAX_MESSAGE_LENGTH_CHARS=4096

# ------------------------------------------------------------------------------
# GCP credentials (somente dev/local)
# Em Cloud Run: não usar; usar a Service Account do serviço com permissões mínimas.
# ------------------------------------------------------------------------------
GOOGLE_APPLICATION_CREDENTIALS=/abs/path/to/service-account.json
GOOGLE_CLOUD_PROJECT=pyloto-corp-dev
